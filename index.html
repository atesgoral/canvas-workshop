<canvas id="stage" width="1920" height="1080"></canvas>
<style>
html, body { height: 100%; }
body { padding: 0; margin: 0; }
#stage { height: 100%; }
</style>
<script>
const MAX_CIRCLES = 250;
const MAX_RADIUS = 2;

const stage = document.getElementById('stage');
const ctx = stage.getContext('2d');
let scale = null;

function resize() {
  const pixelRatio = window.devicePixelRatio || 1;

  stage.width = stage.clientWidth * pixelRatio;
  stage.height = stage.clientHeight * pixelRatio;

  scale = stage.width;

  ctx.scale(scale, scale);
}

resize();

function debounce(fn, delay) {
  let timeout = null;

  return function () {
    if (timeout) {
      clearTimeout(timeout);
    }

    timeout = setTimeout(() => {
      fn.apply(this, arguments);
      timeout = null;
    }, delay);
  };
}

window.addEventListener('resize', debounce(resize, 250));

const circles = [];

while (circles.length < MAX_CIRCLES) {
  circles.push({
    x: Math.random(),
    y: Math.random()
  });
}

function draw(t) {
  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, stage.width, stage.height);

  circles.forEach((circle) => {
    const x = (circle.x + t / 10 / stage.width) % 1;
    const y = circle.y;

    ctx.fillStyle = '#fff';

    ctx.beginPath();
    ctx.arc(x, y, MAX_RADIUS / scale, 0, Math.PI * 2);
    ctx.fill();
  });
}

let epoch = null;

function tick(t) {
  requestAnimationFrame(tick);

  if (epoch === null) {
    epoch = t;
  }

  const elapsed = t - epoch;

  draw(elapsed);
}

requestAnimationFrame(tick);
</script>
